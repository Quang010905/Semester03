@model Semester03.Areas.Client.Models.ViewModels.EventDetailsVm
@using System

@{
    ViewData["Title"] = Model.Title;
    Layout = "~/Areas/Client/Views/Shared/_LayoutClient.cshtml";

    Func<string, string> Img = (raw) =>
    {
        if (string.IsNullOrWhiteSpace(raw))
        {
            return Url.Content("~/images/event-placeholder.png");
        }
        if (raw.StartsWith("http", StringComparison.OrdinalIgnoreCase))
        {
            return raw;
        }
        var s = raw.Replace("wwwroot/", "").TrimStart('~', '/');
        s = s.Replace(" ", "%20");
        if (s.StartsWith("Content", StringComparison.OrdinalIgnoreCase) || s.StartsWith("images", StringComparison.OrdinalIgnoreCase) || s.StartsWith("Admin/img", StringComparison.OrdinalIgnoreCase))
        {
            return Url.Content("~/" + s);
        }
        if (raw.StartsWith("/"))
        {
            return Url.Content("~" + raw);
        }
        return Url.Content("~/Content/Uploads/Events/" + s);
    };
}

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <img src="@Img(Model.ImageUrl)" class="card-img-top" alt="@Model.Title" style="height:320px; object-fit:cover;">
            <div class="card-body">
                <h3>@Model.Title</h3>
                <p class="text-muted small">
                    <span>@Model.StartDate.ToString("dd MMM yyyy HH:mm")</span>
                    @if (Model.EndDate.HasValue)
                    {
                        <span> — @Model.EndDate.Value.ToString("dd MMM yyyy HH:mm")</span>
                    }
                </p>
                <div class="mb-3">@Html.Raw(Model.Description)</div>

                <div class="mt-3">
                    <a href="@Url.Action("Index", "Event", new { area = "Client" })" class="btn btn-outline-secondary btn-sm me-2">Back</a>

                    <a class="btn btn-primary"
                       href="@Url.Action("Register", "EventBooking", new { area = "Client", id = Model.Id })">
                        Register / Booking
                    </a>
                </div>
            </div>
        </div>
    </div>

    <aside class="col-md-4">
        <div class="p-3 bg-light rounded">
            <h6>Event info</h6>
            <p class="small mb-1"><strong>Slots:</strong> @Model.MaxSlot</p>
            <p class="small mb-1"><strong>Status:</strong> @(Model.Status == 1 ? "Active" : "Inactive")</p>
            <p class="small mb-1"><strong>Tenant:</strong> @Model.TenantPositionId</p>
            <a href="@Url.Action("Index", "Event", new { area = "Client" })" class="d-block mt-3">Back to events</a>
        </div>
    </aside>
</div>
