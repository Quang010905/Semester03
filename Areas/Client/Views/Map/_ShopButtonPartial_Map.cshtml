@model Semester03.Areas.Client.Models.ViewModels.TenantPositionDto

@{
    // 4 unit cinema cố định F1-A01..A04 theo script seed
    bool isCinema = Model.TenantPosition_Floor == 1 &&
                    (Model.TenantPosition_Location == "F1-A01"
                     || Model.TenantPosition_Location == "F1-A02"
                     || Model.TenantPosition_Location == "F1-A03"
                     || Model.TenantPosition_Location == "F1-A04");

    string css;
    string mainLabel;
    string tagLabel = "";
    string areaText = (Model?.TenantPosition_Area_M2 ?? 0).ToString("0.#") + " m²";

    if (isCinema)
    {
        css = "shop-unit unit-cinema";
        mainLabel = "ABCD Mall Cinema";
        tagLabel = "CINEMA";
    }
    else if (Model?.TenantPosition_Status == 1 && Model?.Tenant != null)
    {
        css = "shop-unit unit-occupied";
        mainLabel = Model.Tenant.Tenant_Name;
        tagLabel = "Occupied";
    }
    else if (Model?.TenantPosition_Status == 1)
    {
        css = "shop-unit unit-occupied";
        mainLabel = "Occupied";
    }
    else
    {
        css = "shop-unit unit-vacant";
        mainLabel = "VACANT";
        tagLabel = "Available";
    }

    var code = string.IsNullOrWhiteSpace(Model?.TenantPosition_Location)
        ? "Unit"
        : Model.TenantPosition_Location;

    var idAttr = Model?.TenantPosition_ID.ToString() ?? "0";

    string tenantImg = null;
    if (Model?.Tenant != null && !string.IsNullOrWhiteSpace(Model.Tenant.Tenant_Img))
    {
        tenantImg = Model.Tenant.Tenant_Img;
        if (tenantImg.StartsWith("wwwroot/"))
            tenantImg = "/" + tenantImg.Substring("wwwroot/".Length);
    }

    var detailsUrl = Url.Action("Details", "Map", new { area = "Client", id = Model?.TenantPosition_ID });
}

<a href="@detailsUrl"
   class="@css"
   title="@mainLabel"
   data-id="@idAttr"
   data-left="@(Model?.TenantPosition_LeftPct)"
   data-top="@(Model?.TenantPosition_TopPct)"
   data-status="@(Model?.TenantPosition_Status)">
    <div class="unit-code">@code</div>

    @if (!string.IsNullOrEmpty(tenantImg) && !isCinema)
    {
        <div style="flex:0 0 30px;height:30px;overflow:hidden;border-radius:6px;background:#f3f4f6;display:flex;align-items:center;justify-content:center;margin-bottom:2px;">
            <img src="@tenantImg" alt="@mainLabel" style="max-width:100%;max-height:100%;display:block;" />
        </div>
    }

    <div class="unit-name">@mainLabel</div>

    <div class="unit-tag">
        @if (!string.IsNullOrEmpty(tagLabel))
        {
            @tagLabel
            @: ·
        }
        @areaText
    </div>
</a>
